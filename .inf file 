; =======================================================
; CyberPatriot Hardening Template - CP_Hardening.inf
; Applies all User Rights Assignments and Security Policies
; =======================================================

[Unicode]
Unicode=yes
[Version]
signature="$CHICAGO$"
Revision=1

; --- System Access ---
[System Access]
; Accounts
MinimumPasswordLength = 7
MaximumPasswordAge = 90
MinimumPasswordAge = 15
LockoutBadCount = 5
ResetLockoutCount = 30
LockoutDuration = 30
; Administrator and Guest account
AdminAccount = 0
GuestAccount = 0
LimitBlankPasswordUse = 1
; Smart card and interactive logon
DontDisplayLastUserName = 1
DontDisplayLockedUser = 1
RequireCtrlAltDel = 1
; Machine inactivity limit
InactivityTimeoutSecs = 900
; Previous logons cached
CachedLogonsCount = 4
; Prompt before password expiration
PasswordExpiryWarning = 14

; --- Event Audit ---
[Event Audit]
AuditSystemEvents = 1
AuditLogonEvents = 1
AuditObjectAccess = 1
AuditPrivilegeUse = 0
AuditPolicyChange = 1
AuditAccountManage = 1
AuditDSAccess = 1
AuditAccountLogon = 1
ForceAuditPolicySubcategory = 1
ShutdownOnAuditFail = 1

; --- User Rights Assignment ---
[Privilege Rights]
; Access Credential Manager as a trusted caller
SeTrustedCredManAccessPrivilege = 
; Access the computer from the network
SeNetworkLogonRight = Administrators
; Act as part of the operating system
SeTcbPrivilege = 
; Adjust memory quotas for a process
SeIncreaseQuotaPrivilege = Administrators,LocalService,NetworkService
; Allow log on locally
SeInteractiveLogonRight = Administrators,Users
; Allow log on through Remote Desktop Services
SeRemoteInteractiveLogonRight = Administrators,"Remote Desktop Users"
; Back up files and directories
SeBackupPrivilege = Administrators
; Change system time
SeSystemtimePrivilege = Administrators,LocalService
; Change the time zone
SeTimeZonePrivilege = Administrators,LocalService,Users
; Create a pagefile
SeCreatePagefilePrivilege = Administrators
; Create a token object
SeCreateTokenPrivilege = 
; Create global objects
SeCreateGlobalPrivilege = Administrators,LocalService,NetworkService,Service
; Create permanent shared objects
SeCreatePermanentPrivilege = 
; Create symbolic links
SeCreateSymbolicLinkPrivilege = Administrators
; Debug programs
SeDebugPrivilege = Administrators
; Deny access to this computer from the network
SeDenyNetworkLogonRight = Guest,"Local Account"
; Deny log on as batch job
SeDenyBatchLogonRight = Guest
; Deny log on as service
SeDenyServiceLogonRight = Guest
; Deny log on locally
SeDenyInteractiveLogonRight = Guest
; Deny log on through Remote Desktop Services
SeDenyRemoteInteractiveLogonRight = Guest,"Local Account"
; Enable computer and user accounts to be trusted for delegation
SeEnableDelegationPrivilege = 
; Force shutdown from a remote system
SeRemoteShutdownPrivilege = Administrators
; Generate security audits
SeAuditPrivilege = LocalService,NetworkService
; Impersonate a client after authentication
SeImpersonatePrivilege = Administrators,LocalService,NetworkService,Service
; Increase scheduling priority
SeIncreaseBasePriorityPrivilege = Administrators
; Load and unload device drivers
SeLoadDriverPrivilege = Administrators
; Lock pages in memory
SeLockMemoryPrivilege = 
; Log on as batch job
SeBatchLogonRight = Administrators
; Log on as a service
SeServiceLogonRight = 
; Manage auditing and security log
SeSecurityPrivilege = Administrators
; Modify an object label
SeRelabelPrivilege = 
; Modify firmware environment values
SeSystemEnvironmentPrivilege = Administrators
; Perform volume maintenance tasks
SeManageVolumePrivilege = Administrators
; Profile single process
SeProfileSingleProcessPrivilege = Administrators
; Profile system performance
SeSystemProfilePrivilege = Administrators,"NT SERVICE\WdiServiceHost"
; Replace a process level token
SeAssignPrimaryTokenPrivilege = LocalService,NetworkService
; Restore files and directories
SeRestorePrivilege = Administrators
; Shutdown the system
SeShutdownPrivilege = Administrators,Users
; Take ownership of files or objects
SeTakeOwnershipPrivilege = Administrators

; --- Security Options ---
[Security Options]
; Accounts
MsaAdminAccount = 0
MsaGuestAccount = 0
LimitBlankPasswordUse = 1
; Audit
AuditGlobalSystemObjects = 0
AuditUseBackupPrivilege = 0
ForceAuditPolicy = 1
ShutdownOnAuditFail = 1
; DCOM
DCOMMachineAccessCheck = 0
DCOMMachineLaunchCheck = 0
; Devices
UndockWithoutLogon = 0
AllowFormatAndEject = 1
PreventPrinterDriverInstall = 1
; Domain Member
SignSecureChannelData = 1
SignSecureChannelDataIfPossible = 1
EncryptSecureChannelData = 1
EncryptSecureChannelDataIfPossible = 1
DisableMachineAccountChange = 0
MaximumMachineAccountPasswordAge = 30
RequireStrongSessionKey = 1
; Interactive logon
DontDisplayLockedUserId = 1
InteractiveLogon_RequireSmartCard = 0
SmartCardRemovalBehavior = 1
MachineLockoutThreshold = 10
MachineInactivityLimit = 900
CachedLogonsCount = 4
PromptUserChangePasswordBeforeExpiration = 14
RequireDomainControllerForUnlock = 0
; MS Network Client
DigitallySignCommunications = 1
DigitallySignIfServerAgrees = 1
SendUnencryptedPasswordToThirdParty = 0
; MS Network Server
IdleSessionTimeout = 15
DigitallySignServerCommunications = 1
DigitallySignServerIfClientAgrees = 1
DisconnectClientsWhenLogonHoursExpire = 1
ServerSPNValidationLevel = 1
; Network Access
AllowAnonymousSidNameTranslation = 0
NoAnonymousEnumerationSAMAccounts = 1
NoAnonymousEnumerationSAMAccountsAndShares = 1
DontAllowStorageOfPasswordsAndCredentials = 1
LetEveryoneApplyToAnonymous = 0
RestrictAnonymousAccessToNamedPipesAndShares = 1
; Network Security
AllowLocalSystemUseComputerIdentity = 1
AllowLocalSystemNULLSessionFallback = 0
AllowPKU2UOnline = 0
EncryptionTypesAllowedForKerberos = RC4_HMAC_MD5,AES128_HMAC_SHA1,AES256_HMAC_SHA1
DoNotStoreLMHash = 1
ForceLogoffWhenHourExpire = 1
LMCompatibilityLevel = 5
LDAPClientSigningRequirements = 2
MinimumSessionSecurity_NTLM_Client = 3
MinimumSessionSecurity_NTLM_Server = 3
RestrictIncomingNTLM = 1
RestrictDomainNTLM = 1
RestrictOutgoingNTLM = 1
; Recovery Console
RecoveryConsoleAllowAutomaticAdminLogon = 0
RecoveryConsoleAllowFloppyCopy = 0
; Shutdown
ShutdownWithoutLogon = 0
ClearPageFileAtShutdown = 0
; System cryptography
UseFIPSEncryption = 0
; System objects
RequireCaseInsensitivity = 1
StrengthenDefaultPermissions = 1
; System settings
OptionalSubsystems = 
UseCertificateRulesOnExecutables = 0
; UAC
AdminAccountRunMode = 1
AllowUIAccessApplicationsWithoutSecureDesktop = 0
BehaviorOfElevationPromptForAdmins = 2
BehaviorOfElevationPromptForStandardUsers = 0
DetectApplicationInstallations = 1
OnlyElevateSignedExecutables = 0
OnlyElevateUIAccessAppsInSecureLocations = 1
RunAllAdminsInAdminApprovalMode = 1
SwitchToSecureDesktopWhenPrompting = 1
VirtualizeFileAndRegistryWriteFailures = 1
